USE YOUR_DB_NAME

SELECT A.AVG_USER_IMPACT * A.AVG_TOTAL_USER_COST * A.USER_SEEKS AS TOTAL_COST
       ,DB_NAME(C.DATABASE_ID) AS DB_ANME
       ,OBJECT_NAME(C.OBJECT_ID, C.DATABASE_ID) AS TABLE_NAME
       ,C.EQUALITY_COLUMNS 
       ,C.INEQUALITY_COLUMNS 
       ,C.INCLUDED_COLUMNS 
       ,C.STATEMENT 
       ,'USE [' + DB_NAME(C.DATABASE_ID) 
        + ']; CREATE INDEX MRDENNY_' 
        + REPLACE(REPLACE(REPLACE(REPLACE (ISNULL(EQUALITY_COLUMNS, '') + 
        ISNULL(C.INEQUALITY_COLUMNS, ''), ', ', '_'), '[', ''), ']', ''), ' ', 
        '') 
        + '   ON [' + SCHEMA_NAME(D.SCHEMA_ID) + ']   .[' 
        + OBJECT_NAME(C.OBJECT_ID, C.DATABASE_ID) 
        + ']   (' + ISNULL(EQUALITY_COLUMNS, '') + CASE WHEN C.EQUALITY_COLUMNS IS 
        NOT 
        NULL 
        AND C.INEQUALITY_COLUMNS IS NOT NULL THEN ', ' ELSE '' END 
        + ISNULL(C.INEQUALITY_COLUMNS, '') + ')     ' + CASE WHEN INCLUDED_COLUMNS 
        IS NOT 
        NULL THEN 'INCLUDE (' + INCLUDED_COLUMNS + ')' ELSE '' END 
        + '     WITH (FILLFACTOR=70, ONLINE=ON)' 
FROM   SYS.DM_DB_MISSING_INDEX_GROUP_STATS A 
       JOIN SYS.DM_DB_MISSING_INDEX_GROUPS B ON A.GROUP_HANDLE = B.INDEX_GROUP_HANDLE 
       JOIN SYS.DM_DB_MISSING_INDEX_DETAILS C ON B.INDEX_HANDLE = C.INDEX_HANDLE 
       JOIN SYS.OBJECTS D ON C.OBJECT_ID = D.OBJECT_ID 
WHERE  C.DATABASE_ID = DB_ID() 
ORDER  BY  DB_NAME(C.DATABASE_ID) 
          ,ISNULL(EQUALITY_COLUMNS, '') + ISNULL(C.INEQUALITY_COLUMNS, '') 
          ,A.AVG_USER_IMPACT * A.AVG_TOTAL_USER_COST * A.USER_SEEKS DESC  
