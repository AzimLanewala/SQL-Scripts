SQL-Scripts
===========

SQL Scripts
USE YOUR_DB_NAME

DECLARE @TABLE_NAME VARCHAR(100), @STR VARCHAR(2000) , @BUILDSTR VARCHAR(2000), @SEARCHSTR VARCHAR(2000),@DB_NAME VARCHAR(2000)

SET @SEARCHSTR = '%INSERT INTO %'

DECLARE C1 CURSOR
FOR
SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES  WHERE TABLE_CATALOG = 'YOUR_DB_NAME'

OPEN C1
FETCH NEXT FROM C1 INTO @TABLE_NAME
WHILE (@@FETCH_STATUS = 0)
BEGIN

	--SELECT @TABLE_NAME
	
	DECLARE C2 CURSOR
	FOR
	SELECT NAME FROM MASTER.DBO.SYSDATABASES WHERE UPPER(NAME) IN ('YOUR_DB_NAME') AND HAS_DBACCESS(NAME) = 1 ORDER BY NAME

	OPEN C2
	FETCH NEXT FROM C2 INTO @DB_NAME
	WHILE (@@FETCH_STATUS = 0)
	BEGIN
	
   SET @STR = @DB_NAME 
   --select @STR
	
	----************************** FOR SEARCHING IN PROCEDURES IN ALL DB-----------
	
	SET @BUILDSTR = 'USE ' + @STR + CHAR(13) +	
	'
	SELECT   ROUTINE_NAME
			,ROUTINE_DEFINITION
			,ROUTINE_CATALOG 
	FROM INFORMATION_SCHEMA.ROUTINES 
	WHERE ROUTINE_DEFINITION LIKE '''+ @SEARCHSTR + @TABLE_NAME + ' %VALUES%' +'''
	AND ROUTINE_TYPE=''PROCEDURE''
	ORDER BY ROUTINE_NAME'
		
	PRINT (@BUILDSTR)
	 EXEC (@BUILDSTR)
	
	  FETCH NEXT FROM C2 INTO @DB_NAME	
	END	

	CLOSE C2
	DEALLOCATE C2

  FETCH NEXT FROM C1 INTO @TABLE_NAME
END


CLOSE C1
DEALLOCATE C1
